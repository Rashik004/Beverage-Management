!function(n){"use strict";var i=function(n){return typeof n=="object"?n.label:n},u=function(n){return typeof n=="object"?n.id:n},r=function(t){var u=!1,i,r={},f=0,e=t.find(".filter-enabled");return n(":input",t).each(function(){var t=n(this);t.is(e)||(i=t.attr("data-name"),i&&(r[i]=t.val()),u=t.val(),f++)}),n.isEmptyObject(r)?u:r},t=function(t,i){this.options=i;this.$el=n(t);this.$el_=this.$el.clone();this.timeoutId_=0;this.filters={};this.init()};t.DEFAULTS={filters:[],connectTo:!1,onAll:function(){return!1},onFilterChanged:function(){return!1},onResetView:function(){return!1},onAddFilter:function(){return!1},onRemoveFilter:function(){return!1},onEnableFilter:function(){return!1},onDisableFilter:function(){return!1},onSelectFilterOption:function(){return!1},onUnselectFilterOption:function(){return!1},onDataChanged:function(){return!1},onSubmit:function(){return!1}};t.EVENTS={"all.bs.table.filter":"onAll","reset.bs.table.filter":"onResetView","add-filter.bs.table.filter":"onAddFilter","remove-filter.bs.table.filter":"onRemoveFilter","enable-filter.bs.table.filter":"onEnableFilter","disable-filter.bs.table.filter":"onDisableFilter","select-filter-option.bs.table.filter":"onSelectFilterOption","unselect-filter-option.bs.table.filter":"onUnselectFilterOption","data-changed.bs.table.filter":"onDataChanged","submit.bs.table.filter":"onSubmit"};t.FILTER_SOURCES={range:{search:!1,rows:[{id:"lte",label:'Less than <input class="form-control" type="text">'},{id:"gte",label:'More than <input class="form-control" type="text">'},{id:"eq",label:'Equals <input class="form-control" type="text">'}],check:function(n,t){return typeof n.lte!="undefined"&&parseInt(t)>parseInt(n.lte)?!1:typeof n.gte!="undefined"&&parseInt(t)<parseInt(n.gte)?!1:typeof n.eq!="undefined"&&parseInt(t)!=parseInt(n.eq)?!1:!0}},ajaxSelect:{search:!0,rows:[],rowsCallback:function(t,i){var r=this;n.ajax(t.source,{dataType:"json",data:{q:i}}).done(function(n){r.clearFilterOptions(t.field);r.fillFilterOptions(t.field,n)})}},select:{search:!0,rows:[],rowsCallback:function(n,t){var r=n.values;t.length&&(r=r.filter(function(n){return i(n).indexOf(t)>-1}));this.clearFilterOptions(n.field);this.fillFilterOptions(n.field,r.slice(0,20))}}};t.EXTERNALS=[];t.prototype.init=function(){this.initContainer();this.initMainButton();this.initFilters();this.initRefreshButton();this.initFilterSelector();this.initExternals()};t.prototype.initContainer=function(){var t=this;this.$toolbar=n('<div class="btn-toolbar"><div class="btn-group btn-group-filter-main"><button type="button" class="btn btn-default dropdown-toggle btn-filter" data-toggle="dropdown"><span class="glyphicon glyphicon-filter"><\/span><\/button><ul class="dropdown-menu" role="menu"><\/ul><\/div><div class="btn-group btn-group-filters"><\/div><div class="btn-group btn-group-filter-refresh"><button type="button" class="btn btn-default btn-primary btn-refresh" data-toggle="dropdown"><span class="glyphicon glyphicon-repeat"><\/span><\/button><\/div><\/div>');this.$toolbar.appendTo(this.$el);this.$filters=this.$toolbar.find(".btn-group-filters");this.$toolbar.delegate(".btn-group-filters li","click",function(n){n.stopImmediatePropagation()});this.$toolbar.delegate(".btn-group-filters li .filter-enabled","click",function(i){var u=n(this),f=u.closest("[data-filter-field]").attr("data-filter-field"),e=u.closest("[data-val]"),o=e.attr("data-val"),s;u.prop("checked")?(s=r(e),t.selectFilterOption(f,o,s)):t.unselectFilterOption(f,o);i.stopImmediatePropagation()});this.$toolbar.delegate(".btn-group-filters li :input:not(.filter-enabled)","click change",function(i){var u=n(this),e=u.closest("[data-filter-field]").attr("data-filter-field"),f=u.closest("[data-val]"),o=f.attr("data-val"),s=f.find(".filter-enabled"),h;u.val()?(h=r(f),t.selectFilterOption(e,o,h),s.prop("checked",!0)):(t.unselectFilterOption(e,o),s.prop("checked",!1));i.stopImmediatePropagation()});this.$toolbar.delegate(".search-values","keyup",function(){var i=n(this),f=i.val(),e=i.closest("[data-filter-field]").attr("data-filter-field"),r=t.getFilter(e),u=t.getFilterType(r);u.rowsCallback&&u.rowsCallback.call(t,r,f)})};t.prototype.initMainButton=function(){this.$button=this.$toolbar.find(".btn-filter");this.$buttonList=this.$button.parent().find(".dropdown-menu");this.$button.dropdown()};t.prototype.initRefreshButton=function(){var n=this;this.$refreshButton=this.$toolbar.find(".btn-refresh");this.$refreshButton.click(function(){n.trigger("submit",n.getData())})};t.prototype.initFilters=function(){var t=this;this.$buttonList.append('<li class="remove-filters"><a href="javascript:void(0)"><span class="glyphicon glyphicon-remove"><\/span> Remove all filters<\/a><\/li>');this.$buttonList.append('<li class="divider"><\/li>');n.each(this.options.filters,function(n,i){t.addFilter(i)});this.$toolbar.delegate(".remove-filters *","click",function(){n.each(t.filters,function(n,i){t.disableFilter(i.field)})})};t.prototype.initFilterSelector=function(){var t=this,i=function(n){var i=n.closest("[data-filter-field]").attr("data-filter-field");n.prop("checked")?t.enableFilter(i):t.disableFilter(i)};this.$buttonList.delegate("li :input[type=checkbox]","click",function(t){i(n(this));t.stopImmediatePropagation()});this.$buttonList.delegate("li, li a","click",function(t){var r=n(":input[type=checkbox]",this),u;r.length&&(r.prop("checked",!r.is(":checked")),i(r),t.stopImmediatePropagation());u=n(":input[type=text]",this);u.length&&u.focus()})};t.prototype.initExternals=function(){var i=this;n.each(t.EXTERNALS,function(n,t){t.call(i)})};t.prototype.getFilter=function(n){if(typeof this.filters[n]=="undefined")throw"Invalid filter "+n;return this.filters[n]};t.prototype.getFilterType=function(i,r){var f,u;if(i&&(f=typeof i=="object"?i:this.getFilter(i),r=f.type),typeof t.FILTER_SOURCES[r]=="undefined")throw"Invalid filter type "+r;return u=t.FILTER_SOURCES[r],typeof u.extend!="undefined"&&(u=n.extend({},u,this.getFilterType(null,u.extend))),u};t.prototype.checkFilterTypeValue=function(t,i,r){return typeof t.check=="function"?t.check(i,r):typeof i._values!="undefined"?n.inArray(r,i._values)>=0:void 0};t.prototype.clearFilterOptions=function(n){var t=this.getFilter(n);t.$dropdownList.find("li:not(.static)").remove()};t.prototype.fillFilterOptions=function(t,r,f){var s=this,h=this.getFilter(t),e,o;f=f||"";n.each(r,function(r,c){e=u(c);o=s.isSelected(t,e);h.$dropdownList.append(n('<li data-val="'+e+'" class="'+f+'"><a href="javascript:void(0)"><input type="checkbox" class="filter-enabled"'+(o?" checked":"")+"> "+i(c)+"<\/a><\/li>"))})};t.prototype.trigger=function(i){var r=Array.prototype.slice.call(arguments,1);if(i+=".bs.table.filter",typeof t.EVENTS[i]=="undefined")throw"Unknown event "+i;this.options[t.EVENTS[i]].apply(this.options,r);this.$el.trigger(n.Event(i),r);this.options.onAll(i,r);this.$el.trigger(n.Event("all.bs.table.filter"),[i,r])};t.prototype.resetView=function(){this.$el.html();this.init();this.trigger("reset")};t.prototype.addFilter=function(n){this.filters[n.field]=n;this.$buttonList.append('<li data-filter-field="'+n.field+'"><a href="javascript:void(0)"><input type="checkbox"> '+n.label+"<\/a><\/li>");this.trigger("add-filter",n);typeof n.enabled!="undefined"&&n.enabled&&this.enableFilter(n.field)};t.prototype.removeFilter=function(n){this.disableFilter(n);this.$buttonList.find("[data-filter-field="+n+"]").remove();this.trigger("remove-filter",n)};t.prototype.enableFilter=function(t){var i=this.getFilter(t),u=n(['<div class="btn-group" data-filter-field="'+t+'">','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">',i.label,' <span class="caret"><\/span>',"<\/button>",'<ul class="dropdown-menu" role="menu">',"<\/ul>","<\/div>"].join("")),r;u.appendTo(this.$filters);i.$dropdown=u;i.$dropdownList=u.find(".dropdown-menu");i.enabled=!0;this.$buttonList.find("[data-filter-field="+t+"] input[type=checkbox]").prop("checked",!0);r=this.getFilterType(i);r.search&&(i.$dropdownList.append(n('<li class="static"><span><input type="text" class="form-control search-values" placeholder="Search"><\/span><\/li>')),i.$dropdownList.append(n('<li class="static divider"><\/li>')));r.rows&&this.fillFilterOptions(t,r.rows,"static");r.rowsCallback&&r.rowsCallback.call(this,i,"");this.trigger("enable-filter",i)};t.prototype.disableFilter=function(n){var t=this.getFilter(n);this.$buttonList.find("[data-filter-field="+n+"] input[type=checkbox]").prop("checked",!1);t.enabled=!1;t.$dropdown&&(t.$dropdown.remove(),delete t.$dropdown,this.trigger("disable-filter",t))};t.prototype.selectFilterOption=function(n,t,i){var r=this.getFilter(n);typeof r.selectedOptions=="undefined"&&(r.selectedOptions={});i?r.selectedOptions[t]=i:(typeof r.selectedOptions._values=="undefined"&&(r.selectedOptions._values=[]),r.selectedOptions._values.push(t));this.trigger("select-filter-option",n,t,i)};t.prototype.unselectFilterOption=function(t,i){var r=this.getFilter(t);typeof r.selectedOptions!="undefined"&&typeof r.selectedOptions[i]!="undefined"&&delete r.selectedOptions[i];typeof r.selectedOptions!="undefined"&&typeof r.selectedOptions._values!="undefined"&&(r.selectedOptions._values=r.selectedOptions._values.filter(function(n){return n!=i}),r.selectedOptions._values.length==0&&delete r.selectedOptions._values,n.isEmptyObject(r.selectedOptions)&&delete r.selectedOptions);this.trigger("unselect-filter-option",t,i)};t.prototype.isSelected=function(n,t,i){var r=this.getFilter(n);return typeof r.selectedOptions!="undefined"&&(typeof r.selectedOptions[t]!="undefined"&&(i?r.selectedOptions[t]==i:r.selectedOptions[t])||typeof r.selectedOptions._values!="undefined"&&r.selectedOptions._values.indexOf(t.toString())>-1)?!0:!1};t.prototype.getData=function(){var i=this,t={};return n.each(i.filters,function(n,i){i.enabled&&typeof i.selectedOptions!="undefined"&&(t[n]=i.selectedOptions)}),t};n.fn.bootstrapTableFilter=function(i,r){t.externals=this.externals;var f=["addFilter","removeFilter","enableFilter","disableFilter","selectFilterOption","unselectFilterOption","getData","isSelected","resetView"],u;return this.each(function(){var e=n(this),o=e.data("bootstrap.tableFilter"),s=n.extend({},t.DEFAULTS,e.data(),typeof i=="object"&&i);if(typeof i=="string"){if(n.inArray(i,f)<0)throw"Unknown method: "+i;if(!o)return;u=o[i](r);i==="destroy"&&e.removeData("bootstrap.tableFilter")}o||e.data("bootstrap.tableFilter",o=new t(this,s))}),typeof u=="undefined"?this:u};n.fn.bootstrapTableFilter.Constructor=t;n.fn.bootstrapTableFilter.defaults=t.DEFAULTS;n.fn.bootstrapTableFilter.columnDefaults=t.COLUMN_DEFAULTS;n.fn.bootstrapTableFilter.externals=t.EXTERNALS;n(function(){n('[data-toggle="tableFilter"]').bootstrapTableFilter()})}(jQuery);!function(n){"use strict";var i={},t,r,u=function(t,i){var r=!0,u=!0;return(n.each(t,function(n,t){u&&parseInt(t)!=t&&(u=!1);r&&parseFloat(t)!=t&&(r=!1)}),u||r)?{type:"range"}:i?{type:"selectAjax",source:"XXXXX"}:{type:"select"}},f=function(t,i){var r={};return n.each(t,function(n,t){r[t.field]={field:t.field,label:t.title,values:[]}}),n.each(i,function(t,i){n.each(r,function(n){r[n].values.indexOf(i[n])<0&&r[n].values.push(i[n])})}),n.each(r,function(t,i){r[t]=n.extend(r[t],u(i.values))}),r},e=function(r){var u,f=!0;return n.each(r,function(n,r){u=!1;try{u=t.getFilterType(n);u&&typeof i[n]!="undefined"&&(f=f&&t.checkFilterTypeValue(u,i[n],r))}catch(e){}}),f};n.fn.bootstrapTableFilter.externals.push(function(){if(this.options.connectTo){t=this;var u=n(this.options.connectTo),o=u.bootstrapTable("getData"),s=u.bootstrapTable("getColumns"),h=f(s,o,!1);if(n.each(h,function(n,i){t.addFilter(i)}),r=u.bootstrapTable("getServerUrl"),r)this.$el.on("submit.bs.table.filter",function(){i=t.getData();var n=r.indexOf("?")<0?"?":"&",f=r+n+"filter="+encodeURIComponent(JSON.stringify(i));u.bootstrapTable("updateSearch")});else{u.bootstrapTable("registerSearchCallback",e);this.$el.on("submit.bs.table.filter",function(){i=t.getData();u.bootstrapTable("updateSearch")})}}})}(jQuery);!function(n){"use strict";n.extend(n.fn.bootstrapTable.defaults,{showFilter:!1});var t=n.fn.bootstrapTable.Constructor,i=t.prototype.init,r=t.prototype.initSearch;t.prototype.init=function(){i.apply(this,Array.prototype.slice.apply(arguments));var t=this;this.$el.on("load-success.bs.table",function(){t.options.showFilter&&n(t.options.toolbar).bootstrapTableFilter({connectTo:t.$el})})};t.prototype.initSearch=function(){r.apply(this,Array.prototype.slice.apply(arguments));this.options.sidePagination!=="server"&&typeof this.searchCallback=="function"&&(this.data=n.grep(this.options.data,this.searchCallback))};t.prototype.getData=function(){return this.searchText||this.searchCallback?this.data:this.options.data};t.prototype.getColumns=function(){return this.options.columns};t.prototype.registerSearchCallback=function(n){this.searchCallback=n};t.prototype.updateSearch=function(){this.options.pageNumber=1;this.initSearch();this.updatePagination()};t.prototype.getServerUrl=function(){return this.options.sidePagination==="server"?this.options.url:!1};n.fn.bootstrapTable.methods.push("getColumns","registerSearchCallback","updateSearch","getServerUrl")}(jQuery);
//# sourceMappingURL=bootstrap-table-filter.min.js.map
